# 网络攻防 课堂笔记

## 攻击的三个阶段：
准备-攻击-善后
 防护时间 > 检测时间 + 响应时间
 
## DNS服务端口，协议：
53 UDP，UDP无连接，效率更高

## 扫描技术：
	主机扫描：确定在目标网络上的主机是否可达。这是信息收集的初级阶
	段，其效果直接影响到后续的扫描。常用手段：ICMP Echo扫描、ICMP Sweep扫描、Broadcast ICMP扫描、Non-Echo ICMP扫描
	
    端口扫描：通过连接到目标系统的TCP或UDP端口，来确定哪些端口开放？什么服务正在运行
	
    操作系统探测扫描：识别目标OS类型、版本号等信息，攻击更具针对性
	
    漏洞扫描：探测目标主机存在的漏洞，进行针对性攻击

## 交换式局域网如何进行监听：
	
    x分别向A和B发送ARP包，促使其修改ARP表，
	主机A的ARP表中B为<IPb-MACx>
	主机B的ARP表中A为<IPa-MACx>
	X成为主机A和主机B之间的“中间人”
	
## 如何防范交换式网络监听？
	
    监听ARP包，监听通过交换机或者网关的所有ARP数据包，与预先建立的数据库对比，数据可以存储在本地交换机
	定期探测数据包传送路径，与备份的合法路径对比
	使用SNMP定期轮询ARP表
	
## DRDos的原理？
	
    攻击者伪造源地址为受害者地址的SYN连接请求包发送给大量的被欺骗服务器
	服务器群会向源IP（也就是受害者）发出大量的SYN+ACK或RST包来进行响应
	大量服务器的响应数据包最终在受害者处汇集为洪水
	受害者难以隔离攻击洪水流，并且更难找到洪水流的来源
	
## 如何对抗Dos?
	
    加固操作系统，配置各种参数；
	利用防火墙；
	负载均衡；
	带宽限制和QoS保证

## 如何防御DRDoS?
	
    加强源地址管控，对源地址检查，确保源地址合法。

## PEB & TEB

`TEB（Thread Environment Block，线程环境块）系统在此TEB中保存频繁使用的线程相关的数据。`位于用户地址空间，在比 PEB 所在地址低的地方。进程中的每个线程都有自己的一个TEB。一个进程的所有TEB都以堆栈的方式，存放在从0x7FFDE000开始的线性内存中，每 4KB为一个完整的TEB，不过该内存区域是向下扩展的。在用户模式下，当前线程的TEB位于独立的4KB段，可通过CPU的FS寄存器来访问该段，一般存储在[FS:0]。在用户态下WinDbg中可用命令$thread取得TEB地址。

`PEB（Process Environment Block，进程环境块）存放进程信息，每个进程都有自己的PEB信息。`位于用户地址空间。在Win 2000下，进程环境块的地址对于每个进程来说是固定的，在0x7FFDF000处，这是用户地址空间，所以程序能够直接访问。准确的PEB地址应从系统 的EPROCESS结构的0x1b0偏移处获得，但由于EPROCESS在系统地址空间，访问这个结构需要有ring0的权限。