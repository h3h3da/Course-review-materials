# RSA

## RSA加密算法

1. 生成素数p,q，令n=pq，$\phi(n) = (p-1)(q-1)$
2. 选择e，使$gcd(e,\phi(n))=1$
3. 计算$d = e^{-1}\pmod{\phi(n)}$
4. 公钥：n、e
5. 私钥：d、n
6. 加密时，发送方计算$C = M^e\pmod{n}$
7. 解密时，接收方计算$M = C^d\pmod{n} =M^{ed}\pmod{n} = M $

## RSA签名

1. 签名时计算$S = D^d$，D表示待签名的文档
2. 验证时，计算$S^e$是否等于D
3. RSA-PSS签名方案

## RSA的安全性
RSA可能受到如下5种方式的攻击：

· 穷举攻击：试图穷举所有可能的密钥

· 数学攻击：试图分解两个素数的乘积

· 基于硬件故障的攻击：这种方法应用产生签名过程中处理器发生的故障

· 计时攻击：依赖于解密算法的运行时间

· 选择密文攻击：利用了RSA算法的性质

RSA抗穷举攻击的方式是使用大的密钥空间，所以e和d的位数越大越好，但是密钥产生的过程和加/解密过程都包含了复杂的计算，密钥越大，系统的运行速度越慢

### 对RSA的攻击方式
· 攻击思路：分解n为两个素因子p,q。这样可以计算出φ(n)=(p-1)(q-1)，从而可以确定d=e^(-1) mod φ(n) 

· 现在已知的，从e和n确定d的算法时间复杂度至少和因子分解问题一样。因此可以将因子分解的性能作为基准来评价RSA的安全性

· 20世纪90年代一直采用的是二次筛法来进行因子分解。

· 而新的算法：一般数域筛法，可以对RSA-130进行攻击，能够分解比RSA-129更大的数而且计算代价仅为二次筛法的20%

## RSA的填充方案
· 为了防止RSA受到选择密文攻击，RSA公司推荐使用 最优非对称加密填充（OAEP）的方案

· OAEP算法：
```
1. 明文M被填充padding
2. 可选参数集P作为hash函数的输入，输出产生H(P),并用0填充以达到期望长度
3. 将M+padding+H(P)放入数据块DB内
4. 选择一个随机种子作为hash函数的输入，该hash函数称为掩码生成函数（MGF）
5. 将输出的哈市值与DB做异或运算，产生掩码DB（maskedDB）
6. 掩码DB作为MGF的输入，产生一个hash值，该hash值与随机种子进行异或，产生掩码种子
7. 掩码种子和掩码DB连接起来构成消息EM，完成消息的填充
8. 最后直接用RSA对EM进行加密即可
```

